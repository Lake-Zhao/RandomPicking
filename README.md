# RandomPicking - 随机抽奖/点名工具

## 项目简介

[RandomPicking](RandomPicking.py) 是一个基于 Python 开发的随机抽取工具，专为教育工作者、活动组织者设计的实用程序。它支持两种主要模式：

- **文件模式**：从 Excel 文件中随机抽取记录（如随机点名、抽奖）
- **数字模式**：在指定范围内生成随机数字（如抽签、分组）

程序采用友好的图形用户界面，操作简单直观，无需编程基础即可使用。

## 功能特点

### 核心功能

| 功能       | 描述                   |
| -------- | -------------------- |
| Excel 导入 | 支持 .xlsx 和 .xls 格式文件 |
| 多级筛选     | 支持双级分类筛选（如班级+性别）     |
| 批量抽取     | 可一次抽取多个条目            |
| 重复控制     | 允许/禁止重复抽取选项          |
| 历史记录     | 记录所有抽取结果，可以导出        |
| 配置持久化    | 自动保存用户设置             |

### 高级功能

- **用户界面自定义**：可修改界面标题、抽取项名称
- **历史记录导出**：一键导出为 Excel 文件
- **智能记忆**：自动记住上次使用的文件和设置
- **防重复机制**：避免连续抽取相同结果

## 系统要求

- **操作系统**：Windows 7 及以上
- **系统架构**：32位 或 64位 版本（需匹配系统）
- **依赖文件**：程序目录下的 `message.log` 配置文件

>  注意：不支持 MacOS 或 Linux 系统
> 
>  预编译版本（已打包配置文件的）无需提前准备`message.log` 

## 安装方法

### 从源码运行

1. 确保已安装 Python 3.6+

2. 安装依赖库：
   
   ```bash
   pip install pandas openpyxl
   ```

3. 运行程序：
   
   ```bash
   python RandomPicking.py
   ```

### 使用预编译版本

1. 下载对应系统架构的可执行文件（32位/64位）
2. 确保 `message.log` 文件与程序在同一目录（初次使用会自动生成`message.log`文件）
3. 双击运行即可

## 使用指南

### 文件模式（以“随机点名”为例）

1. **选择文件**：
   
   - 点击"选择"按钮浏览并选择 Excel 文件
   - 点击"上传"加载文件

2. **设置筛选条件**：
   
   - 在分类下拉框中选择筛选条件（如班级、小组）
   - 选择"(无)"表示不筛选

3. **设置抽取参数**：
   
   - 在"数量"框中输入抽取人数
   - 勾选"是否重复"允许重复抽取

4. **开始抽取**：
   
   - 点击"抽取"按钮进行随机选择
   - 结果将显示在主显示区

### 数字模式

1. 切换到"数字模式"
2. 在"最小值"和"最大值"框中输入范围
3. 点击"抽取"生成随机数字

### 自定义配置

1. 点击"用户配置"按钮
2. 修改界面元素：
   - 程序标题
   - 主抽取项名称（如"姓名"）
   - 从抽取项名称（如"学号"）
   - 分类项名称（如"班级"、"性别"）
3. 保存配置后程序自动重启生效

## 打包方法

要创建独立的可执行文件：

```bash
pyinstaller --onefile --add-data "message.log;." RandomPicking.py
```

## Excel 文件格式要求

程序需要标准格式的 Excel 文件，示例：

| 姓名  | 学号  | 班级  | 性别  |
| --- | --- | --- | --- |
| 张三  | 1   | 一班  | 男   |
| 李四  | 2   | 二班  | 男   |
| 王五  | 1   | 一班  | 女   |

>  确保表头名称与配置中的抽取项名称匹配

## 开源协议

本项目采用 [MIT 许可证](LICENSE) 开源，允许自由使用、修改和分发。

## 常见问题（Q&A）

Q：为什么"抽取"按钮是灰色的？

A：请先上传有效的 Excel 文件

Q：如何重置所有设置？

A：删除程序目录下的 `message.log` 文件后重启程序

Q：支持多大的 Excel 文件？

A：建议不超过 10,000 行，文件大小 <5MB

Q：历史记录保存在哪里？

A：点击"导出历史"按钮可生成 Excel 文件

## 技术支持

如有任何问题或建议，请联系：

**邮箱**：[lake_zqy@163.com](https://email.163.com/)
**GitHub**：[Lake_Zhao](https://github.com/Lake-Zhao/RandomPicking)

---

>  此`README.md`文件由DeepSeek辅助编写
